# FlukyCoin is Quantum-Resilient Cryptocurrency Project Implemented in Python

I created this blockchain as a hobby project; it was very interesting to delve into the technology. It can be used for familiarization and learning. The project is still developing.

## Project Overview

FlukyCoin — экспериментальная квантово-устойчивая блокчейн-сеть на Python, которую можно собрать и запустить локально для обучения или тестирования протокола.

### Архитектура ядра

**Протокол и криптография.** Класс `Protocol` задаёт параметры времени блока, окна для генерации кандидатов, ограничения по высоте XMSS-ключей и алгоритм выбора победителя блока на основе совпадений хеша адреса с предыдущим хешем цепи; здесь же описаны функции халвинга и расчёта наград.

Подписи и адреса реализованы на XMSS: `XMSSPublicKey` кодирует адрес через Base58, ограничивает число допустимых подписей и поддерживает сериализацию ключей для хранения/передачи.

**Транзакции и блоки.** Базовый класс `Transaction` отвечает за сериализацию, формирование хеша и валидацию XMSS-подписи, а специализированные наследники добавляют перевод средств, создание вспомогательных ключей и coinbase-транзакцию с фиксированным отправителем.

Блоки собираются через `Block.create`: к набору пользовательских транзакций добавляется coinbase с текущей наградой, после чего считается мерклов корень и выполняется подпись XMSS-ключом майнера.

### Хранение и экономика цепи

**Цепь и валидаторы.** Объект `Chain` хранит блоки в SQLite (`node_data/<host_port>/blocks.db`) с сжатием zlib, поддерживает пересчёт сложности и историю хешей, а также проводит комплексную валидацию блоков: проверку номера/времени, лимитов по высоте ключа, корректности транзакций и награды coinbase.

Он же управляет выбором и сменой кандидата, опираясь на алгоритм `Protocol.winner` для разрешения конфликтов между адресами майнеров.

**Мемпул и транзакционное состояние.** Мемпул отслеживает неподтверждённые транзакции, загружая/сохраняя их на диск в `node_data`, и отбрасывает дубликаты или уже включённые хеши.

`TransactionStorage` ведёт балансы, nonce и список майнеров в собственной базе, обновляя их при добавлении или откате блоков; при необходимости можно пересчитать состояние из цепи.

**Майнинговые ключи.** `MinerStorage` генерирует и хранит пул XMSS-ключей, контролируя количество оставшихся подписей и перенося исчерпанные ключи в архив; данные лежат в `node_data/<host_port>/miners_storage.db`.

### Управление нодой и синхронизация

`NodeManager` объединяет цепь, мемпул, майнинговые ключи и сетевые компоненты. Он запускает gRPC-сервер, создаёт блоки при наступлении окна, распространяет кандидатов и закрывает блок после проверки таймеров, сохраняя мемпул и ключи на диск.

`SyncManager` анализирует информацию о пирах, догружает недостающие блоки, следит за рассинхроном и инициирует запросы кандидатов, чтобы оставаться в основной цепи.

### Сетевая подсистема

**gRPC-слой.** `GrpcServer` поднимает сервис на адресе из конфигурации и регистрирует `NetworkService` как обработчик RPC.

Сам сервис ведёт список известных пиров, обрабатывает регистрацию, раздаёт информацию о сети/адресах, транслирует хеши транзакций и блоков, а также отправляет/принимает блок-кандидаты и полные блоки.

`ClientHandler` и `ConnectManager` отвечают за исходящие соединения: они пингуют и регистрируют пиры, получают списки адресов, собирают информацию для синхронизации и рассылки данных.

### Пользовательские инструменты

**GUI-кошелёк.** `WalletApp` предоставляет вкладки для просмотра адресов, создания транзакций и управления ключами; приложение использует `ConnectManager` для выбора доступной ноды и `Wallet` для работы с gRPC.

`Wallet` шифрует ключи через `FileEncryptor`, загружает/сохраняет их в файл и отправляет транзакции/запросы баланса через gRPC-методы ноды.

**Веб-обозреватель.** Flask-приложение в `explorer/app.py` показывает сводку сети, адреса и позволяет запросить баланс через gRPC API, используя тот же протокол, что и кошелёк.

### Конфигурация и запуск

* Установка зависимостей и запуск описаны ниже: клонирование репозитория, `pip install -r requirements.txt`, затем запуск GUI-кошелька или ноды через `python WalletApp.py` и `python main.py`.
* Конфигурации ноды лежат в каталоге `config/`; файл `node_config.yaml` задаёт сетевой адрес, режим майнинга, объём пула ключей и список начальных пиров/адрес вознаграждения.
* `main.py` читает выбранный конфиг, создаёт логгер с именем адреса награды и стартует `NodeManager` в бесконечном цикле до прерывания.

### Диагностика и тестовые скрипты

Каталог `tests/` содержит вспомогательные сценарии для отправки транзакций/блоков, проверки протокола и генерации ключей; например, `tests/add_new_block.py` формирует блок и шлёт его через устаревший RPC-клиент для отладки сетевого стека.

Эти сведения дают целостное представление о проекте и точках расширения, что упрощает последующую разработку или интеграцию.

## Install
```commandline
git clone https://github.com/YGlamazdin/FlukyCoin.git

cd FlukyCoin

pip install -r requirements.txt
```

## Create wallet
```commandline
python WalletApp.py
```

## Make config

example config/node_config.yaml

set you host, address_reward

## Start node
```commandline
python main.py
```

## Explorer

http://5.35.98.126/

"Happiness for everybody, free, and no one will go away unsatisfied!"
